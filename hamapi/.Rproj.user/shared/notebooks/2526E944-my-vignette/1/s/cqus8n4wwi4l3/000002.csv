"0","get_gallery_info <- function(floor=2, size=10){"
"0","  #library(httr)"
"0","  #library(RCurl)"
"0","  #library(svDialogs)"
"0","  #token <- get_token()"
"0","  url1 <- 'http://api.harvardartmuseums.org/gallery?'"
"0","  url2 <- 'floor='"
"0","  url3 <- '&apikey='"
"0","  url4 <- '&size='"
"0",""
"0","  endpoint <- paste(url1, url2, floor, url3, token, url4, size, sep ="""")"
"0","  name <- list()"
"0","  theme <- list()"
"0","  galleryid <- list()"
"0","  gfloor <- list()"
"0","  objectcount <- list()"
"0","  labeltext <- list()"
"0","  url <- list()"
"0",""
"0","  if (floor > 3){"
"0","    stop("
"0","      sprintf("
"0","        ""Only Floor 1 - Floor 3 have galleries"""
"0","      ),"
"0","      call. = FALSE"
"0","    )"
"0","  }"
"0","  if (floor == 1 & size > 20){"
"0","    stop("
"0","      sprintf("
"0","        ""First floor only have 20 galleries"""
"0","      ),"
"0","      call. = FALSE"
"0","    )"
"0","  }"
"0","  if (floor == 2 & size > 24){"
"0","    stop("
"0","      sprintf("
"0","        ""Second floor only have 24 galleries"""
"0","      ),"
"0","      call. = FALSE"
"0","    )"
"0","  }"
"0","  if (floor == 3 & size > 12){"
"0","    stop("
"0","      sprintf("
"0","        ""Third flood only have 12 galleries"""
"0","      ),"
"0","      call. = FALSE"
"0","    )"
"0","  }"
"0","  if (length(endpoint) ==1){"
"0","    webinfo <- GET(endpoint)"
"0","    web <- content(GET(endpoint))"
"0","    status <- as.numeric(status_code(webinfo))"
"0","    if (status != 200){"
"0","      stop("
"0","        sprintf("
"0","          ""Harvard Art Museum request failed"","
"0","          status"
"0","        ),"
"0","        call. = FALSE"
"0","      )"
"0","    }"
"0","    else {"
"0","      for (i in 1: size){"
"0","        if (is.null(web$records[[i]]$url) == TRUE){"
"0","          web$records[[i]]$url = ""no record"""
"0","        }"
"0","        if (is.null(web$records[[i]]$name) == TRUE){"
"0","          web$records[[i]]$name = ""no record"""
"0","        }"
"0","        if (is.null(web$records[[i]]$galleryid) == TRUE){"
"0","          web$records[[i]]$galleryid = ""no record"""
"0","        }"
"0","        if (is.null(web$records[[i]]$objectcount) == TRUE){"
"0","          web$records[[i]]$objectcount = ""no record"""
"0","        }"
"0","        if (is.null(web$records[[i]]$theme) == TRUE){"
"0","          web$records[[i]]$theme = ""no record"""
"0","        }"
"0","        if (is.null(web$records[[i]]$floor) == TRUE){"
"0","          web$records[[i]]$floor = ""no record"""
"0","        }"
"0","        if (is.null(web$records[[i]]$labeltext) == TRUE){"
"0","          web$records[[i]]$labeltext = ""no record"""
"0","        }"
"0","        galleryid[i] <- web$records[[i]]$galleryid"
"0","        url[i] <- web$records[[i]]$url"
"0","        theme[i] <- web$records[[i]]$theme"
"0","        name[i] <- web$records[[i]]$name"
"0","        objectcount[i] <- web$records[[i]]$objectcount"
"0","        labeltext[i] <- web$records[[i]]$labeltext"
"0","        gfloor[i] <- web$records[[i]]$floor"
"0","      }"
"0","      result1 <- list(name, theme, galleryid, gfloor, objectcount, labeltext, url)"
"0","      result2 <- lapply(result1, function(x) ifelse(x == ""NULL"", ""no record"", x))"
"0","      dat <- do.call(cbind, lapply(result2, cbind))"
"0","      result <- as.data.frame(dat)"
"0",""
"0","      colnames(result) <- c(""Name"", ""Theme"", ""Galleryid"", ""Floor"", ""Objectcount"",""Labeltext"",""Url"")"
"0","      rownames(result) <- unlist(galleryid)"
"0","      return(result)"
"0","      #assign(""gallery_result_form"", gresult, envir = globalenv())"
"0","    }"
"0",""
"0","  }"
"0","}"
